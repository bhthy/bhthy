"use strict";angular.module("getlancerApp.Bidding.BiddingReview",["getlancerApp.Bidding.Constant","ngResource","ngSanitize","satellizer","ngAnimate","ui.bootstrap","ui.bootstrap.datetimepicker","ui.router","angular-growl","google.places","angular.filter","ngCookies","angular-md5","ui.select2","http-auth-interceptor","angulartics","pascalprecht.translate","angulartics.google.analytics","tmh.dynamicLocale","ngFileUpload","infinite-scroll","ngTagsInput","angularMoment","bc.Flickity","afkl.lazyImage","angular-loading-bar","ngAnimate","oitozero.ngSweetAlert","slugifier","checklist-model","angularjs-dropdown-multiselect","rzModule"]).config(function($stateProvider,$urlRouterProvider){}),angular.module("getlancerApp.Bidding").directive("biddingReview",function(){return{restrict:"EA",templateUrl:"scripts/plugins/Bidding/BiddingReview/view/default/bidding_project_review.html",scope:{bidid:"@",project:"@",biduser:"@",projectuser:"@",isdispute:"@",projectstatus:"@"},controller:function($scope,$rootScope,$cookies,$state,$filter,flash,SweetAlert,biddingReviewFactory,ProjectEditView){function usersDetail(){var getParams={id:$state.params.id,fields:"id,project_status_id,is_dispute,is_cancel_request_freelancer,is_cancel_request_employer"};ProjectEditView.get(getParams,function(response){$scope.reviewsLists=response.data.reviews,angular.forEach($scope.reviewsLists,function(reviewList){reviewList.user_id==$rootScope.user.id&&($scope.review.rating=reviewList.rating,$scope.review.message=reviewList.message,$scope.reviewid=reviewList.id)})})}$scope.auth=JSON.parse($cookies.get("auth"));var flashMessage;$scope.review={},$scope.rating_review=!0,$scope.reviewSubmit=function(is_valid){if(is_valid&&0==$scope.review.rating?(is_valid=!1,$scope.rating_review=!1):is_valid&&$scope.review.rating>0&&(is_valid=!0,$scope.rating_review=!0),is_valid)if($scope.reviewid){var params={};params.id=$scope.reviewid,params.rating=$scope.review.rating,params.message=$scope.review.message,biddingReviewFactory.put(params,function(response){0===response.error.code?(flashMessage=$filter("translate")("review updated successfully."),flash.set(flashMessage,"success",!1),$scope.closefrm()):(flashMessage=$filter("translate")(response.error.message),flash.set(flashMessage,"error",!1))})}else{var params={};params.foreign_id=$scope.bidid,params["class"]="Bid",params.rating=$scope.review.rating,params.message=$scope.review.message,biddingReviewFactory.post(params,function(response){0===response.error.code?(flashMessage=$filter("translate")("review added successfully."),flash.set(flashMessage,"success",!1),$scope.closefrm()):(flashMessage=$filter("translate")(response.error.message),flash.set(flashMessage,"error",!1))})}},$scope.closefrm=function(){$state.go("Bid_ProjectView",{id:$state.params.id,slug:$state.params.slug,action:"messages"},{reload:!0})},usersDetail()}}}),angular.module("getlancerApp.Bidding.BiddingReview").directive("biddingReviewPost",function(){return{restrict:"E",templateUrl:"scripts/plugins/Bidding/BiddingReview/views/default/bidding_reivew_post.html",scope:{project:"@",projectuser:"@",projectstatus:"@",bidid:"@",biduser:"@",isprojectcancel:"@",isdispute:"@"},controller:function($scope,$rootScope,$state,$filter,$cookies,flash,ProjectStatusConstant){}}}).directive("biddingReviewView",function(){return{restrict:"E",templateUrl:"scripts/plugins/Bidding/BiddingReview/views/default/bidding_reivew_view.html",scope:{project:"@",projectuser:"@",projectstatus:"@",bidid:"@",biduser:"@",isprojectcancel:"@",isdispute:"@"},controller:function($scope,$rootScope,$state,$filter,$cookies,flash,ProjectStatusConstant,BiddingReviews){$scope.postReview=function($valid,data){if($valid){BiddingReviews.post(postReview,function(response){var flashmsg="";0===parseInt(response.error.code)?(flashmsg=$filter("translate")("Review posted successfully"),flash.set(flashmsg,"success",!1),$state.reload()):(flashmsg=$filter("translate")("Review posted failed"),flash.set(flashmsg,"error",!1))})}}}}}),angular.module("getlancerApp.Bidding.BiddingReview").factory("BiddingReviews",["$resource",function($resource){return $resource("/api/v1/reviews",{},{get:{method:"GET"},create:{method:"POST"}})}]).factory("BiddingReview",["$resource",function($resource){return $resource("/api/v1/reviews/:id",{},{get:{method:"GET",params:{id:"@id"}},update:{method:"PUT",params:{id:"@id"}},remove:{method:"DELETE",params:{id:"@id"}}})}]),angular.module("getlancerApp.Bidding.BiddingReview").run(["$templateCache",function($templateCache){$templateCache.put("scripts/plugins/Bidding/BiddingReview/views/default/bidding_project_review.html",'<div id="update" class="submit-review-block clearfix milestone-submit"> <div> <form class="form-horizontal" name="reviewFrm" ng-submit="reviewSubmit(reviewFrm.$valid)" novalidate> <div class="form-group"> <div class=""> <label for="review" class="col-lg-1 col-sm-2">{{\'Rating\'|translate}}:</label> <div class="col-lg-8 col-sm-6 control-label"> <input-stars ng-model="review.rating" max="5" on-star-click="starCount(review.rating)" name="rateing" class="cursor" required></input-stars> <span class="error" ng-show="(review.rating == 0) && (!rating_review)"> {{\' Required \'| translate }} </span> <span class="error" ng-show="(reviewFrm.$submitted || reviewFrm.rateing.$touched) && (reviewFrm.rateing.$pristine || reviewFrm.rateing.$invalid) && (reviewFrm.rateing.$error.required)"> {{\'Required\'| translate }} </span> </div> </div> </div> <div class="form-group"> <div class=""> <label for="review" class="col-lg-1 col-sm-2">{{\'Review\'|translate}}:</label> <div class="col-lg-11 col-sm-10 control-label"> <textarea name="message" ng-model="review.message" class="form-control" rows="3" placeholder="{{\'Review\'|translate}}" required></textarea> <span class="error" ng-show="(reviewFrm.$submitted || reviewFrm.message.$touched) && (reviewFrm.message.$pristine || reviewFrm.message.$invalid) && (reviewFrm.message.$error.required)"> {{\'Required\'| translate }} </span> </div> </div> </div> <div class="col-sm-offset-2 col-lg-offset-1 no-pad"> <button type="submit" class="text-uppercase btn btn-primary">{{\'Submit\'|translate}}</button> <button class="text-uppercase btn btn-danger" ng-click="closefrm()">{{\'Cancel\'|translate}}</button> </div> </form> </div> </div>')}]);